<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Home</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Home</h1>

    



    


    <h3> </h3>










    




    <section>
        <article><h1>FEAR Core Tasks</h1><p>This repo contains all core <code>gulp</code> tasks which can be configured and used in any FEAR projects alltogether or individually.</p>
<p>The Core tasks in this repo are provided in a factory function format for developer convenience, so you can use the functionality but can give any name to the task you create and configure it as much as the Core Task API makes it possible (see examples below).</p>
<h2>Installation</h2><p>To use any of the provided Core gulp tasks, please install the module first:</p>
<pre class="prettyprint source"><code>$ npm install --save-dev git+ssh://git@github.com:DigitalInnovation/fear-core-tasks.git</code></pre><p><strong>PLEASE NOTE</strong> the above command requires <code>npm</code> version <code>2.7.1</code> or above, see this <a href="https://github.com/npm/npm/issues/7121">issue</a>.</p>
<h3>Post install script</h3><p>When <code>npm</code> installs the this core module, it will run the included <code>postinstall</code> script which copies default config files to the application / project's root folder, unless they exist.</p>
<pre class="prettyprint source"><code>$ npm install
FEAR Core tasks: skipped copying default karma.conf.js
File already exists in project root</code></pre><p>This can help scaffolding a new project and also keeping our standards.</p>
<p>The copied default files are:</p>
<ul>
<li><code>.editorconfig</code></li>
<li><code>.eslintrc</code></li>
<li><code>.eslintignore</code></li>
<li><code>.gitignore</code></li>
</ul>
<p>Take a look the <code>node_modules/fear-core-tasks/defaults</code> folder for more details.</p>
<h3>Usage in gulptask.js</h3><p>In <code>gulpfile.js</code> pull in <code>fear-core-tasks</code></p>
<pre class="prettyprint source lang-js"><code>var fearCoreTasks = require('fear-core-tasks');</code></pre><h2>How to create a new core task</h2><p>All core tasks are based on various Gulp plugins and Gulp itself. The basic idea is to create factory functions which can generate Gulp tasks.</p>
<p>These Gulp task &quot;instances&quot; can be also configured via the factory function's arguments e.g. <code>src</code> in the following example.</p>
<pre class="prettyprint source lang-js"><code>'use strict';

var gulp = require('gulp');
var eslint = require('gulp-eslint');

module.exports = function taskFactory (src) {
    return function task () {
        return gulp.src(src)
            .pipe(eslint())
            .pipe(eslint.format())
            .pipe(eslint.failOnError());
    };
};</code></pre><p>which can be then exposed via the package's <code>index.js</code></p>
<pre class="prettyprint source lang-js"><code>'use strict';

module.exports = {
    lintJavascript: require('./path/to/task/module'),
};</code></pre><p>and used in your <code>gulpfile.js</code> multiple times for different sources:</p>
<pre class="prettyprint source lang-js"><code>var core = require('fear-core-tasks');

gulp.task('lint-app', core.lintJavascript('app/**/*.js'));
gulp.task('lint-specs', core.lintJavascript('test/specs/**/*.js'));</code></pre><h2>Available Core tasks</h2><h3>Javascript linting</h3><p>This is done by using <a href="http://eslint.org">ESLint</a> and a default <a href="https://github.com/DigitalInnovation/fear-core-eslint-config">FEAR Core ESLint config</a>.</p>
<p>In your <code>gulpfile</code> register a new task by passing the glob array to the core <code>lintJavascript</code> method:</p>
<pre class="prettyprint source"><code>gulp.task('lint-javascript', fearCoreTasks.lintJavascript(['*.js']) );</code></pre><p>also, create an <code>.eslintrc</code> file in your project's root to extend the Core ESLint config:</p>
<pre class="prettyprint source lang-json"><code>// .eslintrc
{
    &quot;extends&quot;: &quot;fear-core/node-config&quot;
}</code></pre><p>for a browser specific project:</p>
<pre class="prettyprint source lang-json"><code>// .eslintrc
{
    &quot;extends&quot;: &quot;fear-core/browser-config&quot;
}</code></pre><h3>Filtering Javascript linting results</h3><p>The gulp task e.g. the <code>lint-javascript</code> above, can take two arguments <code>--rule</code> and <code>--keyword</code> from the command line, which will eventually filter the results and show only the related errors. The two can be used separately or combined:</p>
<pre class="prettyprint source"><code>$ gulp lint-javascript --rule strict
$ gulp lint-javascript --keyword &quot;blaaa&quot;
$ gulp lint-javascript --rule no-unused-vars --keyword &quot;firstVariable|secondVariable&quot;</code></pre><h3>Javascript linting report</h3><p>This core task gives you an overview of linting errors/warnings by rule having issues.</p>
<pre class="prettyprint source"><code>[12:29:51] Starting 'lint-report'...
[12:29:51] linting errors 1 warnings 0 rule no-unused-vars
[12:29:51] linting errors 3 warnings 0 rule no-console
[12:29:51] total linting errors 4 warnings 0
[12:29:51] Finished 'lint-report' after 205 ms</code></pre><p>This can help you to prioritise which linting issues should be fixed first or to decide which rules to turn off.</p>
<p>In your <code>gulpfile</code> register a new task similar to the <code>lint</code> task, but use the core <code>lintReport</code> method:</p>
<pre class="prettyprint source lang-js"><code>gulp.task('lint-report', fearCoreTasks.lintReport(['*.js']) );</code></pre><p>The <code>lint-report</code> task uses the exact same rules which the <code>lint</code> task does, giving you a summary on all rules which have errors or warnings, aggregating the number of issues.</p>
<h3>Watch: running tasks on file change</h3><p>The <code>watch</code> core task can be used to watch certain files and run the necessary tasks on file change e.g. lint or test.</p>
<p>In your <code>gulpfile</code> register a new task using the core <code>watch</code> method:</p>
<pre class="prettyprint source lang-js"><code>gulp.task('watch', fearCoreTasks.watch(['*.js'], ['lint', 'test']));</code></pre><p>The <code>watch</code> task accepts a glob of files and an array of tasks to run on file changes, e.g. on each Javascript file change it will run the <code>lint</code> and then the <code>test</code> task in <em>sequence</em> using the <code>run-sequence</code> gulp plugin.</p>
<p>There's also an option to add more watches at once, listening to changes of different files and run the appropriate tasks:</p>
<pre class="prettyprint source lang-js"><code>gulp.task('watch', function () {
    fearCoreTasks.watch(['*.js'], ['lint', 'test']);
    fearCoreTasks.watch(['*.scss'], ['compile-sass']);
});</code></pre><p>Also, there's an optional 3rd parameter to run a specific <code>gulp</code> processing first on changed files:</p>
<pre class="prettyprint source lang-js"><code>function runThisFirstOnChanged (files) {
    return gulp.src(files).pipe(lint());
}

gulp.task('watch', fearCoreTasks.watch(['*.js'], ['test', 'build'], runThisFirstOnChanged));</code></pre><p>In the above example, we run linting (only) on the changed files, then the defined tasks will run. If there's a linting error, the rest of the tasks will not run.</p>
<h3>Watching and linting Javascript files</h3><p>A core task is provided to watch a set of files and run linting on each saved file. This helps you to focus on a single file's linting issues.</p>
<p>In your <code>gulpfile</code> register a new task using the core <code>watchAndLintOnChange</code> method:</p>
<pre class="prettyprint source lang-js"><code>gulp.task('watch-and-lint', fearCoreTasks.watchAndLintOnChange(['*.js']));</code></pre><p>When there's a linting error in the file recently saved, you'll see it in the console:</p>
<pre class="prettyprint source"><code>[10:04:41] linting error
/path/to/file/.js
  35:60  error  Missing semicolon  semi

âœ– 1 problem (1 error, 0 warnings)</code></pre><p>After resolving the linting issue, when you save the file you'll see the success message:</p>
<pre class="prettyprint source"><code>[10:05:41] linting OK /path/to/file/.js</code></pre><h3>Watching and linting SCSS files</h3><p>Any <code>.scss</code> file can be watched and linted on change via <a href="https://github.com/juanfran/gulp-scss-lint">gulp-scss-lint</a>.</p>
<p>In your <code>gulpfile</code> register a new task by passing the <code>scss-lint</code> options and the glob array to the core <code>lintSassOnChange</code> method:</p>
<pre class="prettyprint source lang-js"><code>gulp.task('lint-scss', function () {
    var options = { config: '.my-rules.yml' };
    var lintSassOnChange = fearCoreTasks.lintSassOnChange(options);
    fearCoreTasks.watch(['sass/**/*.scss'], ['compile'], lintSassOnChange );
});</code></pre><p>The above task will watch all <code>.scss</code> files under the <code>sass/</code> folder and run linting on the changed file(s), finally compile SASS to CSS via the <code>compile</code> task.</p>
<h3>Running unit tests</h3><p>We're running unit tests via <a href="http://karma-runner.github.io/">Karma</a> test runner. There's a preconfigured <code>karma.conf.js</code> using <code>mocha</code> as the testing framework and <code>chai</code> as the assertion library.</p>
<p>Both <code>mocha</code> and <code>chai</code> is pulled in as a plugin to Karma, so the only thing you have to do is to start writing your unit tests:</p>
<pre class="prettyprint source lang-js"><code>'use strict';

describe('a component under test', function () {

    it('should be unit tested', function() {
        expect(true).to.be.true;
    });

});</code></pre><h4>Targeted browsers</h4><p>The default Karma config uses <a href="http://phantomjs.org/">PhantomJS 1.9.x</a> as the default targeted browser to run the test suite on your local dev machine and get feedback quickly.</p>
<p>You can run the test suite in other browsers as well, also in parallel:</p>
<pre class="prettyprint source lang-js"><code>// karma.config.js
'use strict';

module.exports = function (config) {
    config.set({

        // start these browsers
        // available browser launchers: https://npmjs.org/browse/keyword/karma-launcher
        browsers: ['PhantomJS', 'Chrome', 'Safari']

    });
};</code></pre><p>but you have to install the appropriate launcher e.g.</p>
<pre class="prettyprint source"><code>$ npm install --save-dev karma-safari-launcher</code></pre><h4>Running unit test once</h4><p>To run your unit test suite via Karma, register a new task in your <code>gulpfile</code> and pass an object referring to a <code>karma.conf.js</code> file, also override any Karma config options in there:</p>
<pre class="prettyprint source lang-js"><code>gulp.task('run-unit-tests-once', fearCoreTasks.startKarmaServer({
    configFile: __dirname + '/karma.conf.js',
    files: [ 'test/**/*.spec.js' ],
    singleRun: true
}));</code></pre><h4>Continuously running unit tests</h4><p>When you're practicing TDD, it's important to continuously run your unit test suite on every file change. To achieve that, we start a Karma server with the following gulp task:</p>
<pre class="prettyprint source lang-js"><code>gulp.task('start-karma-server', fearCoreTasks.startKarmaServer({
    configFile: __dirname + '/karma.conf.js',
    files: [ 'test/**/*.spec.js' ]
}));</code></pre><p>The above example starts a Karma server which is waiting for another task to trigger the running of the test suite.</p>
<p>In order to trigger Karma to run the test suite, use the following example in your <code>gulpfile.js</code>:</p>
<pre class="prettyprint source lang-js"><code>gulp.task('run-unit-tests', fearCoreTasks.startKarmaRunner({
    configFile: __dirname + '/karma.conf.js'
}));</code></pre><p>Running also <code>gulp watch</code> in a separate terminal window, will look for file changes and run the unit test suite each time you save a file.</p>
<h4>Using your own Karma config</h4><p>To use your own Karma config amend the path to which the <code>configFile</code> property points to:</p>
<pre class="prettyprint source lang-js"><code>// e.g. karma.conf.js in your project's root
gulp.task('start-karma', fearCoreTasks.startKarmaRunner({
    configFile: __dirname + '/karma-custom.conf.js'
}));</code></pre><p>or amend the existing (default) <code>karma.conf.js</code> under your project's root folder.</p></article>
    </section>






</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-fear-core-tasks.html">fear-core-tasks</a></li><li><a href="module-tasks_javascript.html">tasks/javascript</a></li><li><a href="module-tasks_javascript_annotate.html">tasks/javascript/annotate</a></li><li><a href="module-tasks_javascript_bundle.html">tasks/javascript/bundle</a></li><li><a href="module-tasks_javascript_minify.html">tasks/javascript/minify</a></li><li><a href="module-tasks_javascript_timestamp.html">tasks/javascript/timestamp</a></li><li><a href="module-tasks_start-karma-runner.html">tasks/start-karma-runner</a></li><li><a href="module-tasks_start-karma-server.html">tasks/start-karma-server</a></li></ul><h3>Classes</h3><ul><li><a href="jsPackageHelper.html">jsPackageHelper</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Fri Dec 18 2015 02:47:13 GMT+0000 (GMT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>